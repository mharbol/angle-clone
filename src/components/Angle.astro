---

---

<angle-image>
    <div></div>
</angle-image>

<script>
    const RADIUS = 100;
    const HEIGHT = 200;
    const WIDTH = 300;
    const ARC_RAD = 10;
    const LINE_COLOR = "#0f5bd6";
    const ARC_COLOR = "#ad0a0a";
    const LINE_WIDTH = "2";
    const ARC_WIDTH = "2";
    const MINI_CIRCLE_FILL = "white";
    const MINI_CIRCLE_LINE = "black";
    const MINI_CIRCLE_RAD = "3";

    import makeArc from "@scripts/angle.ts";
    import LfsrRand from "@scripts/lfsr-rand";
    class AngleImage extends HTMLElement {
        constructor() {
            super();

            let now = new Date();
            // const fullDaysSinceEpoch = Math.floor(now.getMilliseconds() / 8.64e7);
            const fullDaysSinceEpoch = Math.floor(now.getMilliseconds());
            const rand = new LfsrRand(fullDaysSinceEpoch + 16);
            const r1 = rand.randInt(0, 360);
            const r2 = rand.randInt(0, 360);
            const angle1rad = (r1 / 180) * Math.PI;
            const angle2rad = (r2 / 180) * Math.PI;
            const deltaAngleRad =
                angle1rad >= angle2rad
                    ? angle1rad - angle2rad
                    : 2 * Math.PI - (angle2rad - angle1rad);

            const div = this.querySelector('div');

            const svg = document.createElementNS("http://www.w3.org/2000/svg", 'svg');
            svg.setAttribute("height", HEIGHT.toString());
            svg.setAttribute("width", WIDTH.toString());

            const arc = document.createElementNS("http://www.w3.org/2000/svg", "path");
            arc.setAttribute("d", makeArc(WIDTH / 2, HEIGHT / 2, ARC_RAD, angle1rad, angle2rad, deltaAngleRad > Math.PI));
            arc.setAttribute("fill", "none");
            arc.setAttribute("stroke-width", ARC_WIDTH);
            arc.setAttribute("stroke", ARC_COLOR);

            const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line1.setAttribute("x1", (WIDTH / 2).toString());
            line1.setAttribute("y1", (HEIGHT / 2).toString());
            line1.setAttribute("x2", (RADIUS * Math.cos(angle1rad) + WIDTH / 2).toString());
            line1.setAttribute("y2", (RADIUS * Math.sin(angle1rad) + HEIGHT / 2).toString());
            line1.setAttribute("stroke-width", LINE_WIDTH);
            line1.setAttribute("stroke", LINE_COLOR);

            const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line2.setAttribute("x1", (WIDTH / 2).toString());
            line2.setAttribute("y1", (HEIGHT / 2).toString());
            line2.setAttribute("x2", (RADIUS * Math.cos(angle2rad) + WIDTH / 2).toString());
            line2.setAttribute("y2", (RADIUS * Math.sin(angle2rad) + HEIGHT / 2).toString());
            line2.setAttribute("stroke-width", LINE_WIDTH);
            line2.setAttribute("stroke", LINE_COLOR);

            const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            circle.setAttribute("cx", (WIDTH / 2).toString());
            circle.setAttribute("cy", (HEIGHT / 2).toString());
            circle.setAttribute("r", MINI_CIRCLE_RAD.toString());
            circle.setAttribute("fill", MINI_CIRCLE_FILL);
            circle.setAttribute("stroke", MINI_CIRCLE_LINE);

            svg?.appendChild(arc);
            svg?.appendChild(line1);
            svg?.appendChild(line2);
            svg?.appendChild(circle);

            div?.appendChild(svg);
        }
    }
    customElements.define("angle-image", AngleImage);
</script>
